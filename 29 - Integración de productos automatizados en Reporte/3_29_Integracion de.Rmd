---
title: "Primer Reporte"
output: word_document
date: "`r Sys.Date()`"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# R Markdown REPORTE

Convertir sus análisis en documentos, informes, presentaciones y tableros de alta calidad. Con ayuda de R Markdown.

# Desarrollo

## 1) Cargar base / librería

Se escribe en código las librerías que en un script utilizamos, así como toda la carga de documentos, cabe aclarar que este código debe ser de solo carga y no mostrarlo en el documento final pues esto no aporta mas documento mas si para la generación de este. Configurar con el _Output_ “Show nothing (run code)”

```{r include=FALSE} 
# Este chop solo se corre y no se muestra en el documento

 # LIBRERIAS
library(readr) # Importar de distintos formatos
library(foreign) # Importar de distintos formatos
library(epiDisplay)
library(haven) # Importar archivos DTA (Stata)
# library(xlsx) # Exportar archivos en Excel
library(Hmisc) # Mostrar estadísticas descriptivas
library(stargazer) # Mostrar estadísticas descriptivas
library(readxl) # Leer libros de excel
library(sjlabelled) # Etiquetar variables
library(tidyverse) # Metapaquete para manipular datos
library(datasets) # Contiene Dataset "iris"
library(ggplot2)
library('data.table')
library(janitor)
```


```{r include=FALSE}
# Este chop solo se corre y no se muestra en el documento

delitos <- read.csv("zacateca_hora_limpia.csv", check.names = F) # Cargar base
# Limpieza de datos
delitos <- clean_names(delitos) # Escritura mas amigable en los titulos
```

## 2) Limpieza y filtrado

Así como en un script debemos cargar todo el código, así como lo hicimos previamente lo cual incluye la limpieza y filtrado de datos que como en el punto anterior debe ser de solo carga y no mostrarse (los filtros de ser necesarios puedo y debo mostrarlos).

## 3) Muestra de los datos

*_Ejemplos_*

### 1._ Nombre de las columnas

Así como en la consola se nos muestra cierta información esta puede ser plasmada en mi documento y para prueba de ello el nombre de las columnas previamente depuradas será mostrado en mi documento.

```{r echo=FALSE}
# Este chop muestra en el documento la lista de los nombres de las columnas

colnames(delitos)
```

### 2._ Información sobre genero de la victima

El primer ejercicio será a partir del genero de la victima donde se realizar la limpieza y filtrado de datos (lo cual no aparecera dentro del documento), para mas adelante generar la tabla de frecuencias y su grafica (se van a mostrar)

#### Tabla con las frecuencias

```{r include=FALSE}
# Este chop solo se corre y no se muestra en el documento

# Generar un data frame con las fecuencias de mi variable
f1 <- table(delitos$sexo_de_la_victima) # Aparto el sexo de la victima

f2 <- as.data.frame(f1) %>%
  rename(valor = Var1, frecuencia = Freq) # Genero el frame con sexo y sus frecuencias

grafica_f2 <- f2[f2$valor %like% "^H|^M", ] # Hago una depuracion en cuanto a terminos especificos

final <- grafica_f2 %>%
  mutate(valor = ifelse(valor %in% c("Hombre", "HOMBRE"), "Hombre", valor)) %>%
  group_by(valor) %>%
  summarise(Frecuencia_Total = sum(frecuencia)) # Unifico los terminos y sumo frecuencias

final$valor[final$valor == "3"] <- "Mujer" # Modifico el valor 11
```

```{r echo=FALSE}
# Este chop solo se muestra en el documento

final
```

#### Grafico de barras con las frecuencias

```{r echo=FALSE}
# Este chop se muestra en el documento

# Generacion del grafico
grafico <- ggplot(final, aes(x = valor, y = Frecuencia_Total)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  labs(title = "Gráfico de Frecuencias", x = "Valor", y = "Frecuencia")

grafico
```

### 3._ Información sobre la edad de la victima

En este segundo ejercicio, se estudiará la edad de la víctima.

```{r include=FALSE}
# Este chop solo se corre y no se muestra en el documento

a <- delitos$edad_de_la_victima # Guardamos la edad de la victima
is.numeric(a) # Verificamos que los datos sean del tipo numerico
a <- as.numeric(a) # Pasamos nuestros datos al tipo numerico
a <- na.omit(a) # Omitimos todos los valores nulos

abc <- data.frame (y=a[a<100]) # Hago un nuevo frame de edades filtrando edad mayor a 100
valores <- abc$y # Genero mi variable donde estaran contenidos los valores
is.numeric(valores)
```

#### Histograma junto la gráfica de densidad usando frecuencias relativas

**Histograma:** Un histograma es un gráfico que se utiliza para representar la distribución de frecuencias de datos de una variable. 

**Grafico de densidad:** Un gráfico de densidad visualiza la distribución de datos cuantitativos en un intervalo continuo. Es una variación de un histograma que usa suavizado de _kernel_ para trazar valores, lo que permite distribuciones más suaves.

```{r echo=FALSE, message=FALSE, warning=FALSE}
# Este chop se muestra en el documento

# Histograma junto la grafica de densidad usando frecuencias relativas
histograma_densidad <- ggplot() +
  aes(valores) +
  geom_histogram(aes(y=..density..), position = "identity", alpha=0.5) + # Añado un histograma
  geom_density(alpha=0.6) + # Añado un grafico de densidad
  labs(title = "Grafica de densidad", x = "Edades", y = "Porcentaje") # Coloco titulos

histograma_densidad
```

#### Grafica de caja

Los diagramas de caja le permiten visualizar y comparar la distribución y la tendencia central de valores numéricos mediante sus cuartiles.

```{r echo=FALSE}
# Este chop se muestra en el documento

boxplot(valores) # Diagrama de caja
```

# EJERCICIO

1. Observar las variables de la base de datos
2. Filtre la base de datos para un delito y un estado
3. Realice por lo menos 3 visualizaciones de los datos con las que puedas reportar información importante
4. Escribir código para generarlas y con _Knit_ generar ni documento del reporte

Guarda este script con tus modificaciones donde exploraste la base de datos, como resultado de tu ejercicio. Sube un archivo de Word del reporte previamente generado.

Compártelo a la siguiente liga: <https://forms.gle/JjWvTV3btQUstGTW7>
